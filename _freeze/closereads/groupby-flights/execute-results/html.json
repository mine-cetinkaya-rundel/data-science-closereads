{
  "hash": "ef1772e6bb717dcafa42d9c8a08e1543",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Group by\ndescription: In this section, we focus on summarizing flight data to uncover broader patterns and trends.\norder: 4\nformat:\n  closeread-html:\n    cr-section:\n      layout: overlay-left\n    cr-style:\n      narrative-background-color-overlay: transparent\n      narrative-background-color-sidebar: transparent\n      section-background-color: transparent\n      narrative-text-color-overlay: black\nknitr:\n  opts_chunk: \n    dev.args:\n      bg: transparent\ncomments:\n  hypothesis: true\n---\n\n# Introduction\n\nIn this section, we focus on summarizing flight data to uncover broader patterns and trends. The goal here is to aggregate the data: grouping flights by meaningful categories such as day of the week, airline, or time of day. This allows us to answer higher-level questions like *Which days are busiest?, When do delays happen most often?*, or *What are the main reasons for cancellations over time?* By grouping the data and calculating summary statistics, we can efficiently condense large datasets into interpretable insight.\n\n## Data\n\nThis project uses data from the American Statistical Association's Data Expo, which provides comprehensive flight information covering various aspects of flight operations. The dataset contains data about flights across the United States, recording details such as departure times, scheduled and actual arrival times, flight durations, distances, and reasons for delays. The dataset used in this story consists of flights departing from Raleigh-Durham International Airport (RDU) in November 2023, headed to destinations in North Carolina and California.\n\n\n::: {.cell}\n\n:::\n\n\n## Examples\n\n::::{.cr-section}\n\nFirst, let's look at the dataset that we will be using for the analysis.[@cr-grouby-0]{highlight=\"1\"}\n\n:::{#cr-grouby-0}\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 368 × 110\n    year quarter month day_of_month day_of_week flight_date reporting_airline\n   <dbl>   <dbl> <dbl>        <dbl>       <dbl> <date>      <chr>            \n 1  2023       4    11            1           3 2023-11-01  AA               \n 2  2023       4    11            2           4 2023-11-02  AA               \n 3  2023       4    11            3           5 2023-11-03  AA               \n 4  2023       4    11            4           6 2023-11-04  AA               \n 5  2023       4    11           25           6 2023-11-25  AA               \n 6  2023       4    11           26           7 2023-11-26  AA               \n 7  2023       4    11            1           3 2023-11-01  AA               \n 8  2023       4    11            2           4 2023-11-02  AA               \n 9  2023       4    11            3           5 2023-11-03  AA               \n10  2023       4    11            4           6 2023-11-04  AA               \n# ℹ 358 more rows\n# ℹ 103 more variables: dot_id_reporting_airline <dbl>,\n#   iata_code_reporting_airline <chr>, tail_number <chr>,\n#   flight_number_reporting_airline <dbl>, origin_airport_id <dbl>,\n#   origin_airport_seq_id <dbl>, origin_city_market_id <dbl>, origin <chr>,\n#   origin_city_name <chr>, origin_state <chr>, origin_state_fips <dbl>,\n#   origin_state_name <chr>, origin_wac <dbl>, dest_airport_id <dbl>, …\n```\n\n\n:::\n:::\n\n:::\n\nWe begin with a simple example: counting the number of flights on each day of the week. To do this, we use the `group_by()` function to group the data by the `day_of_week` variable. It’s important to note that when `group_by()` is used on its own, the output looks identical to the original data frame, with no visible change occurs. That’s because group_by() doesn’t modify the data directly. This grouping only becomes meaningful when combined with a function like `summarize()`, which uses that metadata to compute statistics for each group.[@cr-groupby-1a]{highlight=\"3\"}\n\n:::{#cr-groupby-1a}\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 368 × 110\n# Groups:   day_of_week [7]\n    year quarter month day_of_month day_of_week flight_date reporting_airline\n   <dbl>   <dbl> <dbl>        <dbl>       <dbl> <date>      <chr>            \n 1  2023       4    11            1           3 2023-11-01  AA               \n 2  2023       4    11            2           4 2023-11-02  AA               \n 3  2023       4    11            3           5 2023-11-03  AA               \n 4  2023       4    11            4           6 2023-11-04  AA               \n 5  2023       4    11           25           6 2023-11-25  AA               \n 6  2023       4    11           26           7 2023-11-26  AA               \n 7  2023       4    11            1           3 2023-11-01  AA               \n 8  2023       4    11            2           4 2023-11-02  AA               \n 9  2023       4    11            3           5 2023-11-03  AA               \n10  2023       4    11            4           6 2023-11-04  AA               \n# ℹ 358 more rows\n# ℹ 103 more variables: dot_id_reporting_airline <dbl>,\n#   iata_code_reporting_airline <chr>, tail_number <chr>,\n#   flight_number_reporting_airline <dbl>, origin_airport_id <dbl>,\n#   origin_airport_seq_id <dbl>, origin_city_market_id <dbl>, origin <chr>,\n#   origin_city_name <chr>, origin_state <chr>, origin_state_fips <dbl>,\n#   origin_state_name <chr>, origin_wac <dbl>, dest_airport_id <dbl>, …\n```\n\n\n:::\n:::\n\n:::\n\nThe `group_by()` function is followed by `summarize()` to count the number of records within each group. In this example, `n()` is used to count the number of rows in each group, giving us a frequency count of flights by day of the week.[@cr-groupby-1b]{highlight=\"3\"}\n\n:::{#cr-groupby-1b}\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 2\n  day_of_week flight_count\n        <dbl>        <int>\n1           1         8853\n2           2         8505\n3           3         8561\n4           4         8829\n5           5         8864\n6           6         7167\n7           7         8637\n```\n\n\n:::\n:::\n\n:::\n\nIn our next example, we group data by month and cancellation code to see trends over the year in terms of why flights are cancelled, showing problematic months or operational challenges during certain periods. By applying `group_by(month, cancellation_code)`, we create grouped combinations of each month and cancellation reason.[@cr-groupby-2a]{highlight=\"2\"}\n\n:::{#cr-groupby-2a}\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 59,416 × 110\n# Groups:   month, cancellation_code [46]\n    year quarter month day_of_month day_of_week flight_date reporting_airline\n   <dbl>   <dbl> <dbl>        <dbl>       <dbl> <date>      <chr>            \n 1  2023       1     1            9           1 2023-01-09  9E               \n 2  2023       1     1           10           2 2023-01-10  9E               \n 3  2023       1     1           11           3 2023-01-11  9E               \n 4  2023       1     1           12           4 2023-01-12  9E               \n 5  2023       1     1           13           5 2023-01-13  9E               \n 6  2023       1     1           14           6 2023-01-14  9E               \n 7  2023       1     1           15           7 2023-01-15  9E               \n 8  2023       1     1           16           1 2023-01-16  9E               \n 9  2023       1     1           17           2 2023-01-17  9E               \n10  2023       1     1           18           3 2023-01-18  9E               \n# ℹ 59,406 more rows\n# ℹ 103 more variables: dot_id_reporting_airline <dbl>,\n#   iata_code_reporting_airline <chr>, tail_number <chr>,\n#   flight_number_reporting_airline <dbl>, origin_airport_id <dbl>,\n#   origin_airport_seq_id <dbl>, origin_city_market_id <dbl>, origin <chr>,\n#   origin_city_name <chr>, origin_state <chr>, origin_state_fips <dbl>,\n#   origin_state_name <chr>, origin_wac <dbl>, dest_airport_id <dbl>, …\n```\n\n\n:::\n:::\n\n:::\n\nThis enables us to count how many cancellations occurred for each reason in each month using `summarize()` and `n()`. After summarization, we use `.groups = \"drop\"` to remove the grouping structure, so the output is returned as a regular, ungrouped dataframe. [@cr-groupby-2b]{highlight=\"3\"}\n\n:::{#cr-groupby-2b}\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 46 × 3\n   month cancellation_code cancellation\n   <dbl> <chr>                    <int>\n 1     1 A                           10\n 2     1 B                           28\n 3     1 C                           19\n 4     1 D                            2\n 5     1 <NA>                      4247\n 6     2 A                           15\n 7     2 B                           30\n 8     2 C                            1\n 9     2 <NA>                      4016\n10     3 A                           18\n# ℹ 36 more rows\n```\n\n\n:::\n:::\n\n:::\n\n\nNext, we analyze how flight performance varies across different times of the day, grouped by airline. We begin by using `mutate()` along with `case_when()` to create a new categorical variable, `time_of_day`, derived from `crs_dep_time` (the scheduled departure time). Each flight is categorized into one of four time blocks. [@cr-groupby-3a]{highlight=\"2-9\"}\n\n:::{#cr-groupby-3a}\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 59,416 × 111\n    year quarter month day_of_month day_of_week flight_date reporting_airline\n   <dbl>   <dbl> <dbl>        <dbl>       <dbl> <date>      <chr>            \n 1  2023       1     1            9           1 2023-01-09  9E               \n 2  2023       1     1           10           2 2023-01-10  9E               \n 3  2023       1     1           11           3 2023-01-11  9E               \n 4  2023       1     1           12           4 2023-01-12  9E               \n 5  2023       1     1           13           5 2023-01-13  9E               \n 6  2023       1     1           14           6 2023-01-14  9E               \n 7  2023       1     1           15           7 2023-01-15  9E               \n 8  2023       1     1           16           1 2023-01-16  9E               \n 9  2023       1     1           17           2 2023-01-17  9E               \n10  2023       1     1           18           3 2023-01-18  9E               \n# ℹ 59,406 more rows\n# ℹ 104 more variables: dot_id_reporting_airline <dbl>,\n#   iata_code_reporting_airline <chr>, tail_number <chr>,\n#   flight_number_reporting_airline <dbl>, origin_airport_id <dbl>,\n#   origin_airport_seq_id <dbl>, origin_city_market_id <dbl>, origin <chr>,\n#   origin_city_name <chr>, origin_state <chr>, origin_state_fips <dbl>,\n#   origin_state_name <chr>, origin_wac <dbl>, dest_airport_id <dbl>, …\n```\n\n\n:::\n:::\n\n:::\n\nAfter defining the time periods, we apply `group_by()` with both `reporting_airline` and our newly derived variable `time_of_day`.[@cr-groupby-3b]{highlight=10}\n\n:::{#cr-groupby-3b}\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 59,416 × 111\n# Groups:   reporting_airline, time_of_day [13]\n    year quarter month day_of_month day_of_week flight_date reporting_airline\n   <dbl>   <dbl> <dbl>        <dbl>       <dbl> <date>      <chr>            \n 1  2023       1     1            9           1 2023-01-09  9E               \n 2  2023       1     1           10           2 2023-01-10  9E               \n 3  2023       1     1           11           3 2023-01-11  9E               \n 4  2023       1     1           12           4 2023-01-12  9E               \n 5  2023       1     1           13           5 2023-01-13  9E               \n 6  2023       1     1           14           6 2023-01-14  9E               \n 7  2023       1     1           15           7 2023-01-15  9E               \n 8  2023       1     1           16           1 2023-01-16  9E               \n 9  2023       1     1           17           2 2023-01-17  9E               \n10  2023       1     1           18           3 2023-01-18  9E               \n# ℹ 59,406 more rows\n# ℹ 104 more variables: dot_id_reporting_airline <dbl>,\n#   iata_code_reporting_airline <chr>, tail_number <chr>,\n#   flight_number_reporting_airline <dbl>, origin_airport_id <dbl>,\n#   origin_airport_seq_id <dbl>, origin_city_market_id <dbl>, origin <chr>,\n#   origin_city_name <chr>, origin_state <chr>, origin_state_fips <dbl>,\n#   origin_state_name <chr>, origin_wac <dbl>, dest_airport_id <dbl>, …\n```\n\n\n:::\n:::\n\n:::\n\nWe can then use `summarize()` to calculate two key metrics: `average_delay`: The mean departure delay within each group; `on_time_rate`: The proportion of flights that departed on time or early. We also use `.groups = \"drop\"` to return the result as an ungrouped data frame.\n\n:::{#cr-groupby-3c}\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 13 × 4\n   reporting_airline time_of_day   average_delay on_time_rate\n   <chr>             <chr>                 <dbl>        <dbl>\n 1 9E                Early Morning         10.4         0.713\n 2 AA                Early Morning         16.8         0.677\n 3 AS                Early Morning          7.21        0.559\n 4 B6                Early Morning         27.9         0.502\n 5 DL                Early Morning         11.5         0.661\n 6 F9                Early Morning         19.7         0.589\n 7 MQ                Early Morning          5.73        0.709\n 8 NK                Early Morning         34.1         0.382\n 9 OH                Early Morning         13.0         0.774\n10 OO                Early Morning          1.42        0.788\n11 UA                Early Morning         13.2         0.658\n12 WN                Early Morning          9.35        0.546\n13 YX                Early Morning          1.72        0.841\n```\n\n\n:::\n:::\n\n:::\n\n::::\n\n# Summary\nIn this section, we explored how to use `group_by()` to gain grouped insights. By pairing `group_by()` with `summarize()`, we were able to condense individual flight records into summaries, such as flight counts by day, cancellation reasons by month, and delay patterns across different times of day.\n\nWe also highlighted the power of `mutate()` in grouped workflows. Before summarizing, `mutate()` allowed us to define new variables like `time_of_day`, giving context to the data and enabling more meaningful groupings.\n\nAs we wrap up, take a moment to reflect on and note down what you've learned from this example:\n\n<input type=\"text\" id=\"inputText\" name=\"inputText\" placeholder=\"Type something...\" style=\"width: 50%; height: 200px; font-size: 20px; padding: 10px; border: 2px solid #000000; border-radius: 4px;\">",
    "supporting": [
      "groupby-flights_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
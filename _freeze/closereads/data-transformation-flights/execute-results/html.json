{
  "hash": "11010ea0c683c085fa303fa46a87f8ba",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Flights Data Transformation Example\nsubtitle: \"Skeleton for the scrolly-telling project\"\nformat:\n  closeread-html:\n    cr-section:\n      layout: overlay-left\n    cr-style:\n      narrative-background-color-overlay: transparent\n      narrative-background-color-sidebar: transparent\n      section-background-color: transparent\n      narrative-text-color-overlay: black\nknitr:\n  opts_chunk: \n    dev.args:\n      bg: transparent\ncomments:\n  hypothesis: true\n---\n\n**Adapted from sample document from <https://closeread.dev/gallery/demos/build-up-plots/>**\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(arrow)\n```\n:::\n\n::::{.cr-section}\n\nIn the first line we load the `tidyverse` package, which contains the `ggplot2` and `dplyr` packages we need. [@cr-dplyr]{highlight=\"1\"}\n\nWe then load the data frame `flights`. This dataset is now ready for analysis or manipulation in R. [@cr-dplyr]{highlight=\"2\"}\n\nThe main block of code is referred as a pipeline or chain. Each line starts with a function and ends with a pipe operator, `|>`. The pipe operator in R is used to pass one expression as the input to the next expression, creating a sequence of operations that's easy to read and manage.  [@cr-dplyr]{highlight=\"4-16\"}\n\nWe use the `filter()` function to retain only those rows in the data frame where `Origin` is \"RDU\", `DestState` is either \"NC\" or \"CA\", and with month equals to 11, as we are only focusing the flights departing from RDU, with destinations in North Carolina or in California, in November 2023. [@cr-dplyr]{highlight=\"5-9\"}\n\nWe want to select the variables that are used in the data visualization: `DepDelay`, `ArrDelay`, `DestState`. [@cr-dplyr]{highlight=\"10-12\"}\n\nWe then rename the variable `DestState` to \"Destination_State\". [@cr-dplyr]{highlight=\"13-15\"}\n\nWe finally remove all rows from the `spotify_songs` data frame that contain `NA` values in any column.[@cr-dplyr]{highlight=\"16\"}\n\nWe use `head()` to display the first five rows of the dataset after transformation.[@cr-dplyr]{highlight=\"17\"}\n\n:::{#cr-dplyr}\n::: {.cell}\n\n```{.r .cell-code}\n# Keep this pipe and show it step by step\n# include more variables in select() to identify the flights e.g. flight number, date, destination cities\n\nlibrary(tidyverse)\nflights <- read_parquet(\"Year=2023/data_0.parquet\")\n\nflights_rdu <- flights |>\n  filter(\n    Origin == \"RDU\",\n    DestState %in% c(\"NC\", \"CA\"), # NC and CA\n    Month == 11\n  ) |>\n  select(\n    c(\"DepDelay\", \"ArrDelay\", \"DestState\")\n  ) |>\n  rename(\n    \"Destination_State\" = DestState\n  )\n\nflights_rdu\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 368 × 3\n   DepDelay ArrDelay Destination_State\n      <dbl>    <dbl> <chr>            \n 1       -2        1 CA               \n 2       -7      -22 CA               \n 3       -4      -29 CA               \n 4       -8      -27 CA               \n 5       -4        3 NC               \n 6       18       23 NC               \n 7       -7       -8 NC               \n 8       -7       -9 NC               \n 9       47       29 NC               \n10       19        5 NC               \n# ℹ 358 more rows\n```\n\n\n:::\n:::\n:::\n\n:::{cr-arrange}\n::: {.cell}\n\n```{.r .cell-code}\n# add arrange and relocate at the end\n\nflights_rdu <- flights |>\n  filter(\n    Origin == \"RDU\",\n    DestState %in% c(\"NC\", \"CA\"), # NC and CA\n    Month == 11\n  ) |>\n  select(\n    c(\"DepDelay\", \"ArrDelay\", \"DestState\")\n  ) |>\n  rename(\n    \"Destination_State\" = DestState\n  ) |>\n  relocate(\n    Destination_State, .before = DepDelay\n  ) |>\n  arrange(\n    desc(DepDelay)\n  )\n\nflights_rdu\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 368 × 3\n   Destination_State DepDelay ArrDelay\n   <chr>                <dbl>    <dbl>\n 1 CA                     209      215\n 2 NC                     174      166\n 3 NC                     166      159\n 4 NC                     150      144\n 5 NC                     137      146\n 6 NC                     102       98\n 7 NC                      78       72\n 8 CA                      72       62\n 9 NC                      71       57\n10 NC                      71       60\n# ℹ 358 more rows\n```\n\n\n:::\n:::\n:::\n\n:::{cr-slice}\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  Destination_State DepDelay ArrDelay\n  <chr>                <dbl>    <dbl>\n1 CA                     209      215\n2 NC                     174      166\n3 NC                     166      159\n```\n\n\n:::\n:::\n:::\n::::\n\n**Insert inline code cell here**",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}